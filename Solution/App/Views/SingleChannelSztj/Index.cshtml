
@{
    ViewBag.Title = "单河道水质统计";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div id="app">
    <singlechannelsztj-query v-on:emit-event="getEmitEvent" ref="SingleChannelsztjQuery"></singlechannelsztj-query>
    <div id="tableData">
        <template>
            <el-table v-bind:data="tableData"
                      stripe
                      border
                      style="width: 100%;"
                      v-bind:height="tableHeight">
                <el-table-column prop="id"
                                 label="序号"
                                 width="60" 
                                 header-align="center"
                                 align="center">
                </el-table-column>
                <el-table-column prop="hdid"
                                 label="河道编号"
                                 header-align="center"
                                 align="center" >
                </el-table-column>
                <el-table-column prop="name"
                                 label="河道名称"
                                 header-align="center" 
                                 align="left"> 
                </el-table-column>
                <el-table-column prop="hz"
                                 label="河长"
                                 header-align="center"
                                 align="left">
                </el-table-column>
                <el-table-column prop="dm"
                                 label="断面名称" 
                                 header-align="center"
                                 align="left">
                </el-table-column>
                <el-table-column prop="ssz"
                                 label="所属镇"
                                 header-align="center"
                                 align="center">
                </el-table-column>
                <el-table-column prop="sz"
                                 label="水质类别" 
                                 header-align="center"
                                 align="left">
                </el-table-column>
            </el-table>
        </template>
      
    </div>
    <div style="text-align:right;padding-top:10px;">
        <el-pagination @@size-change="sizeChange" @@current-change="currentChange" layout="total, sizes, prev, pager, next, jumper" v-bind:current-page.sync="currentPage" v-bind:page-size="pageSize" v-bind:page-sizes="[10, 20, 30, 40, 50]" v-bind:total="total">
        </el-pagination>
    </div>
   
</div>

@Html.Partial("~/Views/SingleChannelSztj/components/query.cshtml")



<script>
    new Vue({
        el: "#app",
        data: {
            styles: {
                width: '90%',
                height: '0px',
                float: 'left',
            },
            height: '0px',
          // tableData: [],
            tableData: [{
                id: '1',
                hdid: 'SHFXHD0010213678',
                name: '张翁庙机口河',
                hz:'王大锤',
                dm: '肖南路淀港河桥',
                ssz: '龙港镇',
                sz: 'V类',
            }, {
                id: '2',
                hdid: 'SHFXHD0010213678',
                name: '张翁庙机口河',
                hz: '王大锤',
                dm: '肖南路淀港河桥',
                ssz: '南桥镇',
                sz: '劣V类',
            }, {
                id: '3',
                hdid: 'SHFXHD0010213678',
                name: '张翁庙机口河',
                hz: '王大锤',
                dm: '肖南路淀港河桥',
                ssz: '木港镇',
                sz: 'IV类',
            }, ],
            total: 0, //默认数据总数
            pageSize: 10,//每页的数据条数
            currentPage: 1,//默认开始页面
            params: []
        },
        components: {
            "singlechannelsztj-query": query,
        },
        mounted: function () {
            this.setSize()
            this.resize()
            this.setTableData('/SingleChannelSztj/GetProjectData', { Page: this.currentPage, pageSize: this.pageSize, startYear: moment().format("YYYY"), endYear: moment().format("YYYY"), Status: '', Town: '', NameNum: '' });
            ////this.$refs.smallQuery.gStatus   this.$refs.smallQuery.gTown
        },
        methods: {
            indexMethod: function (index) {
                return (index + 1) + (this.currentPage - 1) * this.pageSize;
            },
          
            getEmitEvent: function (param) {
                this.setTableData('/SingleChannelSztj/GetProjectData', {
                    Page: this.currentPage, pageSize: this.pageSize, startYear: param.startYear, endYear: param.endYear, Status: param.Status, Town: param.Town, NameNum: param.NameNum,
                });
            },
            setTableData: function (url, param) {
                this.params = param;
                axios.post(url, param)
                  .then(function (response) {
                      var tempData = JSON.parse(response.data);
                      //var datas = tempData.EnginListGetResponse.engin_list;
                      this.tableData = tempData.EnginListGetResponse.engin_list;
                      this.total = tempData.EnginListGetResponse.totalCount;
                  }.bind(this))
                  .catch(function (error) {
                      console.log(error);
                  });

            },
            currentChange: function (val) {
                this.currentPage = val;
                this.params.Page = val;
                this.setTableData('/SingleChannelSztj/GetProjectData', this.params)
            },

            sizeChange: function (val) {
                this.pageSize = val;
                this.params.pageSize = val;
                this.setTableData('/SingleChannelSztj/GetProjectData', this.params)
            },
            setSize: function () {
                var docH = document.documentElement.clientHeight
                var queryH = this.$refs.SingleChannelsztjQuery.$el.clientHeight
                var contentH = docH - queryH - 40
                this.height = contentH - 5
            },
            resize: function () {
                $(window).resize(function () {
                    this.setSize()
                }.bind(this));
            },
        }

    })
</script>


<style scoped>
    html, body, #app {
        width: 100%;
        height: 100%;
        overflow: hidden;
        margin: 0;
        padding: 0;
    }

    header {
        font-size: 14px;
        font-family: 宋体;
        color: #333333;
        border-bottom: 1px solid #b9b9b9;
        height: 100px;
        width: 100%;
    }

        header .el-select .el-input__inner {
            width: 150px;
            height: 32px;
        }

    .el-input__inner {
        height: 32px;
    }

    header .el-button {
        padding: 8px 16px;
    }

    header .el-input__icon {
        line-height: 32px;
    }

    .el-table thead {
        background-color: #F5F5F5;
    }

    tbody .el-table_1_column_7 {
        /*color: blue;*/
        color:#f42d8e;
    }

    .el-dialog {
        height: 600px;
        width: 900px;
        position: relative;
    }

    .el-dialog__header {
        background-color: #2288f1;
        padding: 10px 20px;
    }

    .titlebg {
        background-color: white;
        width: 5px;
        height: 18px;
        position: absolute;
        top: 13px;
        left: 9px;
    }

    .el-dialog__headerbtn .el-dialog__close {
        color: white;
    }

        .el-dialog__headerbtn .el-dialog__close:hover {
            color: white;
            background-color: #6eb1f6;
        }

    .el-dialog__headerbtn {
        top: 13px;
        right: 16px;
    }

    .el-dialog__title {
        color: white; 
    }

    #qyjlSelect {
        margin: -10px 0 12px 0px;
    }

        #qyjlSelect .sqqyjltext {
            margin-right: 30px;
            font-size: 16px;
            color: #666666;
            font-family: 'Microsoft YaHei';
        }

        #qyjlSelect .el-button {
            padding: 8px 15px;
        }

        #qyjlSelect .el-input__icon {
            line-height: 34px;
        }

        #qyjlSelect .el-date-editor.el-input, .el-date-editor.el-input__inner {
            width: 200px;
        }

    .el-table--border {
        margin-bottom: 4px;
    }

    .el-pagination {
        float: right;
    }
</style>